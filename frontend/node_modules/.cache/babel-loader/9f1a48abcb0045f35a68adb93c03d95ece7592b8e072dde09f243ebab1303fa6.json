{"ast":null,"code":"import * as ERROR_MSGS from \"../constants/error_msgs\";\nimport * as METADATA_KEY from \"../constants/metadata_keys\";\nimport { getFirstArrayDuplicate } from \"../utils/js\";\nfunction targetIsConstructorFunction(target) {\n  return target.prototype !== undefined;\n}\nfunction _throwIfMethodParameter(parameterName) {\n  if (parameterName !== undefined) {\n    throw new Error(ERROR_MSGS.INVALID_DECORATOR_OPERATION);\n  }\n}\nfunction tagParameter(annotationTarget, parameterName, parameterIndex, metadata) {\n  _throwIfMethodParameter(parameterName);\n  _tagParameterOrProperty(METADATA_KEY.TAGGED, annotationTarget, parameterIndex.toString(), metadata);\n}\nfunction tagProperty(annotationTarget, propertyName, metadata) {\n  if (targetIsConstructorFunction(annotationTarget)) {\n    throw new Error(ERROR_MSGS.INVALID_DECORATOR_OPERATION);\n  }\n  _tagParameterOrProperty(METADATA_KEY.TAGGED_PROP, annotationTarget.constructor, propertyName, metadata);\n}\nfunction _ensureNoMetadataKeyDuplicates(metadata) {\n  var metadatas = [];\n  if (Array.isArray(metadata)) {\n    metadatas = metadata;\n    var duplicate = getFirstArrayDuplicate(metadatas.map(function (md) {\n      return md.key;\n    }));\n    if (duplicate !== undefined) {\n      throw new Error(ERROR_MSGS.DUPLICATED_METADATA + \" \" + duplicate.toString());\n    }\n  } else {\n    metadatas = [metadata];\n  }\n  return metadatas;\n}\nfunction _tagParameterOrProperty(metadataKey, annotationTarget, key, metadata) {\n  var metadatas = _ensureNoMetadataKeyDuplicates(metadata);\n  var paramsOrPropertiesMetadata = {};\n  if (Reflect.hasOwnMetadata(metadataKey, annotationTarget)) {\n    paramsOrPropertiesMetadata = Reflect.getMetadata(metadataKey, annotationTarget);\n  }\n  var paramOrPropertyMetadata = paramsOrPropertiesMetadata[key];\n  if (paramOrPropertyMetadata === undefined) {\n    paramOrPropertyMetadata = [];\n  } else {\n    var _loop_1 = function (m) {\n      if (metadatas.some(function (md) {\n        return md.key === m.key;\n      })) {\n        throw new Error(ERROR_MSGS.DUPLICATED_METADATA + \" \" + m.key.toString());\n      }\n    };\n    for (var _i = 0, paramOrPropertyMetadata_1 = paramOrPropertyMetadata; _i < paramOrPropertyMetadata_1.length; _i++) {\n      var m = paramOrPropertyMetadata_1[_i];\n      _loop_1(m);\n    }\n  }\n  paramOrPropertyMetadata.push.apply(paramOrPropertyMetadata, metadatas);\n  paramsOrPropertiesMetadata[key] = paramOrPropertyMetadata;\n  Reflect.defineMetadata(metadataKey, paramsOrPropertiesMetadata, annotationTarget);\n}\nfunction createTaggedDecorator(metadata) {\n  return function (target, targetKey, indexOrPropertyDescriptor) {\n    if (typeof indexOrPropertyDescriptor === \"number\") {\n      tagParameter(target, targetKey, indexOrPropertyDescriptor, metadata);\n    } else {\n      tagProperty(target, targetKey, metadata);\n    }\n  };\n}\nfunction _decorate(decorators, target) {\n  Reflect.decorate(decorators, target);\n}\nfunction _param(paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n}\nfunction decorate(decorator, target, parameterIndexOrProperty) {\n  if (typeof parameterIndexOrProperty === \"number\") {\n    _decorate([_param(parameterIndexOrProperty, decorator)], target);\n  } else if (typeof parameterIndexOrProperty === \"string\") {\n    Reflect.decorate([decorator], target, parameterIndexOrProperty);\n  } else {\n    _decorate([decorator], target);\n  }\n}\nexport { decorate, tagParameter, tagProperty, createTaggedDecorator };","map":{"version":3,"names":["ERROR_MSGS","METADATA_KEY","getFirstArrayDuplicate","targetIsConstructorFunction","target","prototype","undefined","_throwIfMethodParameter","parameterName","Error","INVALID_DECORATOR_OPERATION","tagParameter","annotationTarget","parameterIndex","metadata","_tagParameterOrProperty","TAGGED","toString","tagProperty","propertyName","TAGGED_PROP","constructor","_ensureNoMetadataKeyDuplicates","metadatas","Array","isArray","duplicate","map","md","key","DUPLICATED_METADATA","metadataKey","paramsOrPropertiesMetadata","Reflect","hasOwnMetadata","getMetadata","paramOrPropertyMetadata","m","some","_i","paramOrPropertyMetadata_1","length","push","apply","defineMetadata","createTaggedDecorator","targetKey","indexOrPropertyDescriptor","_decorate","decorators","decorate","_param","paramIndex","decorator","parameterIndexOrProperty"],"sources":["../../src/annotation/decorator_utils.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}